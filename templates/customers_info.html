{% extends "base_generic.html" %}


{% block head %}
<link rel="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.3/css/bootstrap.css"/>
<link rel="https://cdn.datatables.net/1.10.20/css/dataTables.bootstrap4.min.css"/>
<link rel="https://cdn.datatables.net/buttons/1.6.1/css/buttons.dataTables.min.css"/>
<!--<link rel="stylesheet" type="text/css" href="https://cdn.datatables.net/v/bs4/dt-1.10.20/b-1.6.1/b-colvis-1.6.1/b-html5-1.6.1/fh-3.1.6/sl-1.3.1/datatables.min.css"/>-->

{% endblock %}
{% load widget_tweaks %}
{% block body %}
<script>

</script>
<div class="content">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-header card-header-primary">
                        <h4 class="card-title ">Segments Info</h4>
                    </div>

                    <form method="get">

                        <div class="form-group col-sm-4 col-md-3" style="display: inline-block;">
                            {{ values_filter.form.customer_email.label_tag }}
                            {% render_field values_filter.form.customer_email class="form-control" %}
                        </div>

                        <div class="form-group col-sm-8 col-md-3" style="display: inline-block;">
                            {{ values_filter.form.segment.label_tag }}
                            <div>
                                {% for s in values_filter.form.segment %}
                                <div class="form-check">
                                    <label class="form-check-label">
                                        {{ s.tag }} {{ s.choice_label }}
                                    </label>
                                </div>
                                {% endfor %}
                            </div>
                        </div>

                        <div class="form-group col-sm-8 col-md-3" style="display: inline-block;">
                            {{ values_filter.form.purchase_status.label_tag }}
                            <div>
                                {% for ps in values_filter.form.purchase_status %}

                                <div class="form-check">

                                    <label class="form-check-label">
                                        {{ ps.tag }} {{ ps.choice_label }}
                                    </label>
                                </div>
                                {% endfor %}
                            </div>
                        </div>
                        <div class="card-footer">
                            <button type="submit" class="btn btn-fill btn-primary" style="display: inline-block;">Search</button>
                            <div id="export-btn" style="display: inline-block;"></div>
                        </div>
                    </form>
                    
                </div>
            </div>
            <div class="card">
                <div class="table-responsive">
                    <table id="segment_table" class="table" style="width:100%">
                        <thead>

                        <th>Customer ID</th>
                        <th>Frequency</th>
                        <th>Monetary</th>
                        <th>Avg Monetary</th>
                        <th>Recency</th>
                        <th>First Purchase</th>
                        <th>Avg Days Purchase</th>
                        <th>Std. Dev. Purchase</th>
                        <th>Score Frequency</th>
                        <th>Score Monetary</th>
                        <th>Segment</th>
                        <th>Segment</th>

                        </thead>
                        <tbody>
                        {% for element in values_filter.qs %}
                        <tr>
                            <td>{{ element.customer_email }}</td>
                            <td>{{ element.frequency }}</td>
                            <td><script>formataDinheiro({{ element.monetary }})</script></td>
                            <td width="100%"><script>formataDinheiro({{ element.avg_monetary }})</script></td>
                            <td>{{ element.recency }}</td>
                            <td>{{ element.first_purchase }} days</td>
                            <td>{{ element.avg_days|floatformat }}</td>
                            <td>{{ element.std_dev_days|floatformat }}</td>
                            <td>{{ element.score_frequency }}</td>
                            <td>{{ element.score_monetary }}</td>
                            <td>{{ element.segment.title }}</td>
                            <td>{{ element.purchase_status.title }}</td>

                        </tr>
                        {% endfor %}

                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>
</div>

{% endblock %}

{% block scripts %}
<script>
$('#segments_information').addClass("active")
$(document).ready(function() {
    var table = $('#segment_table').DataTable(
        {
            select: true,
            bFilter: false
        }
        );
    
    var buttons = new $.fn.dataTable.Buttons( table, {
        buttons: [

            {
                extend: 'excelHtml5',
                className: 'btn btn-fill btn-primary waves-effect waves-light',
                title: 'segments'

            }

        ]
    } ).container().appendTo($('#export-btn'))
} );

<!--https://datatables.net/extensions/buttons/examples/initialisation/export.html-->














</script>
<script src="https://code.jquery.com/jquery-3.3.1.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/1.10.20/js/dataTables.bootstrap4.min.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.1/js/dataTables.buttons.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.1.3/jszip.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.53/vfs_fonts.js"></script>
<script src="https://cdn.datatables.net/buttons/1.6.1/js/buttons.html5.min.js"></script>
<!--<script type="text/javascript" src="https://cdn.datatables.net/v/bs4/dt-1.10.20/b-1.6.1/b-colvis-1.6.1/b-html5-1.6.1/fh-3.1.6/sl-1.3.1/datatables.min.js"></script>"-->
{% endblock %}